/**
 * byte-buffer v1.0.3
 * Copyright (c) 2012-2015 Tim Kurvers <tim@moonsphere.net>
 *
 * Wrapper for JavaScript's ArrayBuffer/DataView.
 *
 * Licensed under the MIT license.
 */

!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.ByteBuffer=e()}}(function(){return function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){var r=t[o][1][e];return i(r?r:e)},h,h.exports,e,t,r,n)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){var t=void 0===arguments[0]?0:arguments[0],n=void 0===arguments[1]?this.constructor.BIG_ENDIAN:arguments[1],i=void 0===arguments[2]?!1:arguments[2];r(this,e),this._buffer=null,this._raw=null,this._view=null,this._order=!!n,this._implicitGrowth=!!i,this._index=0;var a=this._extractBuffer(t,!0);a||(a=new ArrayBuffer(t)),this.buffer=a}return n(e,[{key:"_sanitizeIndex",value:function(){this._index<0&&(this._index=0),this._index>this.length&&(this._index=this.length)}},{key:"_extractBuffer",value:function(e){var t=void 0===arguments[1]?!1:arguments[1];if(e&&"undefined"!=typeof e.byteLength)return"undefined"!=typeof e.buffer?t?e.buffer.slice(0):e.buffer:t?e.slice(0):e;if(!e||"undefined"==typeof e.length)return null;if(e.constructor==String)return null;try{return new Uint8Array(e).buffer}catch(r){return null}}},{key:"front",value:function(){return this._index=0,this}},{key:"end",value:function(){return this._index=this.length,this}},{key:"seek",value:function(){var e=void 0===arguments[0]?1:arguments[0];return this.index+=e,this}},{key:"read",value:function(){var t=void 0===arguments[0]?this.available:arguments[0];if(t>this.available)throw new Error("Cannot read "+t+" byte(s), "+this.available+" available");if(0>=t)throw new RangeError("Invalid number of bytes "+t);var r=new e(this._buffer.slice(this._index,this._index+t),this.order);return this._index+=t,r}},{key:"write",value:function(e){var t;if(e instanceof Uint8Array)t=e;else{var r=this._extractBuffer(e);if(!r)throw new TypeError("Cannot write "+e+", not a sequence");t=new Uint8Array(r)}var n=this.available;if(t.byteLength>n){if(!this._implicitGrowth)throw new Error("Cannot write "+e+" using "+t.byteLength+" byte(s), "+this.available+" available");this.append(t.byteLength-n)}return this._raw.set(t,this._index),this._index+=t.byteLength,this}},{key:"readString",value:function(){var e=void 0===arguments[0]?this.available:arguments[0];if(e>this.available)throw new Error("Cannot read "+e+" byte(s), "+this.available+" available");if(0>=e)throw new RangeError("Invalid number of bytes "+e);for(var t,r,n,i=this._raw,a=[],o=0,s=null,u=this._index+e;this._index<u;)if(t=i[this._index],128>t)a[o++]=t,this._index++;else{if(194>t)throw new Error("Unexpected continuation byte");if(224>t){if(r=i[this._index+1],128>r||r>191)throw new Error("Bad continuation byte");a[o++]=((31&t)<<6)+(63&r),this._index+=2}else if(240>t){if(r=i[this._index+1],128>r||r>191)throw new Error("Bad continuation byte");if(n=i[this._index+2],128>n||n>191)throw new Error("Bad continuation byte");a[o++]=((15&t)<<12)+((63&r)<<6)+(63&n),this._index+=3}else{if(!(245>t))throw new Error("Illegal byte");if(r=i[this._index+1],128>r||r>191)throw new Error("Bad continuation byte");if(n=i[this._index+2],128>n||n>191)throw new Error("Bad continuation byte");if(s=i[this._index+3],128>s||s>191)throw new Error("Bad continuation byte");var h=((7&t)<<18)+((63&r)<<12)+((63&n)<<6)+(63&s);h-=65536,a[o++]=55296+((1047552&h)>>>10),a[o++]=56320+(1023&h),this._index+=4}}var f=65536,l=a.length;if(f>l)return String.fromCharCode.apply(String,a);for(var d=[],g=0;l>g;)d.push(String.fromCharCode.apply(String,a.slice(g,g+f))),g+=f;return d.join("")}},{key:"writeString",value:function(e){for(var t=[],r=e.length,n=0,i=0;r>n;){var a=e.charCodeAt(n);if(127>=a)t[i++]=a;else if(2047>=a)t[i++]=192|(1984&a)>>>6,t[i++]=128|63&a;else if(55295>=a||a>=57344&&65535>=a)t[i++]=224|(61440&a)>>>12,t[i++]=128|(4032&a)>>>6,t[i++]=128|63&a;else{if(n==r-1)throw new Error("Unpaired surrogate "+e[n]+" (index "+n+")");var o=e.charCodeAt(++n);if(55296>a||a>56319||56320>o||o>57343)throw new Error("Unpaired surrogate "+e[n]+" (index "+n+")");var s=((1023&a)<<10)+(1023&o)+65536;t[i++]=240|(1835008&s)>>>18,t[i++]=128|(258048&s)>>>12,t[i++]=128|(4032&s)>>>6,t[i++]=128|63&s}++n}return this.write(t),t.length}},{key:"readCString",value:function(){for(var e=this._raw,t=e.length,r=this._index;0!=e[r]&&t>r;)++r;if(t=r-this._index,t>0){var n=this.readString(t);return this.readByte(),n}return null}},{key:"writeCString",value:function(e){var t=this.writeString(e);return this.writeByte(0),++t}},{key:"prepend",value:function(e){if(0>=e)throw new RangeError("Invalid number of bytes "+e);var t=new Uint8Array(this.length+e);return t.set(this._raw,e),this._index+=e,this.buffer=t.buffer,this}},{key:"append",value:function(e){if(0>=e)throw new RangeError("Invalid number of bytes "+e);var t=new Uint8Array(this.length+e);return t.set(this._raw,0),this.buffer=t.buffer,this}},{key:"clip",value:function(){var e=void 0===arguments[0]?this._index:arguments[0],t=void 0===arguments[1]?this.length:arguments[1];0>e&&(e=this.length+e);var r=this._buffer.slice(e,t);return this._index-=e,this.buffer=r,this}},{key:"slice",value:function t(){var r=void 0===arguments[0]?0:arguments[0],n=void 0===arguments[1]?this.length:arguments[1],t=new e(this._buffer.slice(r,n),this.order);return t}},{key:"clone",value:function i(){var i=new e(this._buffer.slice(0),this.order,this.implicitGrowth);return i.index=this._index,i}},{key:"reverse",value:function(){return Array.prototype.reverse.call(this._raw),this._index=0,this}},{key:"toArray",value:function(){return Array.prototype.slice.call(this._raw,0)}},{key:"toString",value:function(){var e=this._order==this.constructor.BIG_ENDIAN?"big-endian":"little-endian";return"[ByteBuffer; Order: "+e+"; Length: "+this.length+"; Index: "+this._index+"; Available: "+this.available+"]"}},{key:"toHex",value:function(){var e=void 0===arguments[0]?" ":arguments[0];return Array.prototype.map.call(this._raw,function(e){return("00"+e.toString(16).toUpperCase()).slice(-2)}).join(e)}},{key:"toASCII",value:function(){var e=void 0===arguments[0]?" ":arguments[0],t=void 0===arguments[1]?!0:arguments[1],r=void 0===arguments[2]?"ï¿½":arguments[2],n=t?" ":"";return Array.prototype.map.call(this._raw,function(e){return 32>e||e>126?n+r:n+String.fromCharCode(e)}).join(e)}},{key:"buffer",get:function(){return this._buffer},set:function(e){this._buffer=e,this._raw=new Uint8Array(this._buffer),this._view=new DataView(this._buffer),this._sanitizeIndex()}},{key:"raw",get:function(){return this._raw}},{key:"view",get:function(){return this._view}},{key:"length",get:function(){return this._buffer.byteLength}},{key:"byteLength",get:function(){return this.length}},{key:"order",get:function(){return this._order},set:function(e){this._order=!!e}},{key:"implicitGrowth",get:function(){return this._implicitGrowth},set:function(e){this._implicitGrowth=!!e}},{key:"index",get:function(){return this._index},set:function(e){if(0>e||e>this.length)throw new RangeError("Invalid index "+e+", should be between 0 and "+this.length);this._index=e}},{key:"available",get:function(){return this.length-this._index}}],[{key:"LITTLE_ENDIAN",value:!0,enumerable:!0},{key:"BIG_ENDIAN",value:!1,enumerable:!0}]),e}(),a=function(e,t){return function(){var r=void 0===arguments[0]?this._order:arguments[0];if(t>this.available)throw new Error("Cannot read "+t+" byte(s), "+this.available+" available");var n=this._view[e](this._index,r);return this._index+=t,n}},o=function(e,t){return function(r){var n=void 0===arguments[1]?this._order:arguments[1],i=this.available;if(t>i){if(!this._implicitGrowth)throw new Error("Cannot write "+r+" using "+t+" byte(s), "+i+" available");this.append(t-i)}return this._view[e](this._index,r,n),this._index+=t,this}};i.prototype.readByte=a("getInt8",1),i.prototype.readUnsignedByte=a("getUint8",1),i.prototype.readShort=a("getInt16",2),i.prototype.readUnsignedShort=a("getUint16",2),i.prototype.readInt=a("getInt32",4),i.prototype.readUnsignedInt=a("getUint32",4),i.prototype.readFloat=a("getFloat32",4),i.prototype.readDouble=a("getFloat64",8),i.prototype.writeByte=o("setInt8",1),i.prototype.writeUnsignedByte=o("setUint8",1),i.prototype.writeShort=o("setInt16",2),i.prototype.writeUnsignedShort=o("setUint16",2),i.prototype.writeInt=o("setInt32",4),i.prototype.writeUnsignedInt=o("setUint32",4),i.prototype.writeFloat=o("setFloat32",4),i.prototype.writeDouble=o("setFloat64",8),t.exports=i},{}]},{},[1])(1)});