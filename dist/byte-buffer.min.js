/**
 * ByteBuffer v0.0.1
 * Copyright (c) 2012 Tim Kurvers <http://moonsphere.net>
 *
 * Wrapper for ArrayBuffer/DataView maintaining index and default endianness.
 * Supports arbitrary reading/writing, automatic growth, slicing, cloning and
 * reversing as well as UTF-8 characters and NULL-terminated C-strings.
 *
 * The contents of this file are subject to the MIT License, under which
 * this library is licensed. See the LICENSE file for the full license.
 */
var ByteBuffer;ByteBuffer=function(){function g(b,c){var d;b==null&&(b=0),c==null&&(c=this.constructor.BIG_ENDIAN),this._buffer=null,this._raw=null,this._view=null,this._order=c,this._index=0,d=a(b,!0),d||(d=new ArrayBuffer(b)),this._setup(d)}"use strict";var a,b,c,d,e,f=this;return g.LITTLE_ENDIAN=!0,g.BIG_ENDIAN=!1,b=function(a,b){return Object.defineProperty(g.prototype,a,{get:b,enumerable:!0,configurable:!0})},d=function(a,b){return Object.defineProperty(g.prototype,a,{set:b,enumerable:!0,configurable:!0})},g.prototype._setup=function(a){return this._buffer=a,this._raw=new Uint8Array(this._buffer),this._view=new DataView(this._buffer)},a=function(a,b){b==null&&(b=!1);if(a.byteLength!=null)return a.buffer!=null?b?a.buffer.slice(0):a.buffer:b?a.slice(0):a;if(a.length==null)return null;try{return(new Uint8Array(a)).buffer}catch(c){return null}},b("buffer",function(){return this._buffer}),b("view",function(){return this._view}),b("length",function(){return this._buffer.byteLength}),b("byteLength",function(){return this.length}),b("order",function(){return this._order}),d("order",function(a){return this._order=!!a}),b("index",function(){return this._index}),d("index",function(a){if(a<0||a>this.length)throw new RangeError("Invalid index "+a+", should be between 0 and "+this.length);return this._index=a}),g.prototype.front=function(){return this._index=0,this},g.prototype.end=function(){return this._index=this.length,this},g.prototype.skip=function(a){return a==null&&(a=1),this.index+=a,this},b("available",function(){return this.length-this._index}),c=function(a,b){return function(c){var d;c==null&&(c=this._order);if(b>this.available)throw new Error("Cannot read "+b+" byte(s), "+this.available+" available");return d=this._view[a](this._index,c),this._index+=b,d}},e=function(a,b){return function(c,d){d==null&&(d=this._order);if(b>this.available)throw new Error("Cannot write "+c+" using "+b+" byte(s), "+this.available+" available");return this._view[a](this._index,c,d),this._index+=b,this}},g.prototype.readByte=c("getInt8",1),g.prototype.readUnsignedByte=c("getUint8",1),g.prototype.readShort=c("getInt16",2),g.prototype.readUnsignedShort=c("getUint16",2),g.prototype.readInt=c("getInt32",4),g.prototype.readUnsignedInt=c("getUint32",4),g.prototype.readFloat=c("getFloat32",4),g.prototype.readDouble=c("getFloat64",8),g.prototype.writeByte=e("setInt8",1),g.prototype.writeUnsignedByte=e("setUint8",1),g.prototype.writeShort=e("setInt16",2),g.prototype.writeUnsignedShort=e("setUint16",2),g.prototype.writeInt=e("setInt32",4),g.prototype.writeUnsignedInt=e("setUint32",4),g.prototype.writeFloat=e("setFloat32",4),g.prototype.writeDouble=e("setFloat64",8),g.prototype.read=function(a){var b;a==null&&(a=this.available);if(a>this.available)throw new Error("Cannot read "+a+" byte(s), "+this.available+" available");return b=new this.constructor(this._buffer.slice(this._index,this._index+a)),this._index+=a,b},g.prototype.write=function(b){var c;if(!(b instanceof Uint8Array)){c=a(b);if(!c)throw new TypeError("Cannot write "+b+", not a sequence");b=new Uint8Array(c)}if(b.byteLength>this.available)throw new Error("Cannot write "+b+" using "+b.byteLength+" byte(s), "+this.available+" available");return this._raw.set(b,this._index),this._index+=b.byteLength,this},g.prototype.toArray=function(){return Array.prototype.slice.call(this._raw,0)},g.prototype.toString=function(){var a;return a=this._order===this.constructor.BIG_ENDIAN?"big-endian":"little-endian","[ByteBuffer; Order: "+a+"; Length: "+this.length+"; Index: "+this._index+"]"},g}.call(this);